<!DOCTYPE html>
<html class="dark" lang="zh-CN"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>reado: 交易中心</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1978e5",
                        "neon-cyan": "#00f3ff",
                        "background-light": "#f6f7f8",
                        "background-dark": "#111821",
                        "card-dark": "#1a242f",
                    },
                    fontFamily: {
                        "display": ["'Source Han Sans SC'", "'Inter'", "sans-serif"],
                        "sans": ["'Source Han Sans SC'", "'Inter'", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<style type="text/tailwindcss">
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Source Han Sans SC', 'Inter', sans-serif;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .glass-panel {
            background: rgba(17, 24, 33, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }
        .neon-shadow {
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }
        .neon-text {
            text-shadow: 0 0 8px rgba(0, 243, 255, 0.4);
        }
        .nav-active {
            background: linear-gradient(90deg, rgba(0, 243, 255, 0.15) 0%, transparent 100%);
            border-left: 3px solid #00f3ff;
            color: #00f3ff;
        }
        .logo-font {
            font-family: 'Lexend', sans-serif;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-slate-200 h-screen overflow-hidden flex flex-col font-display">
<style id="reado-shell-boot-style">
body.reado-shell-pending {
  background: #0b1220;
}
body.reado-shell-pending > :not(script):not(reado-app-shell):not(.reado-shell-boot-mask) {
  visibility: hidden !important;
}
body > .reado-shell-boot-mask {
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;
  opacity: 0;
  background:
    radial-gradient(1200px 420px at 20% -10%, rgba(47, 123, 255, 0.22), transparent 60%),
    radial-gradient(900px 360px at 92% 112%, rgba(0, 234, 255, 0.14), transparent 58%),
    #0b1220;
  transition: opacity 180ms ease;
}
body.reado-shell-pending > .reado-shell-boot-mask {
  opacity: 1;
}
body.reado-shell-ready > .reado-shell-boot-mask {
  opacity: 0;
}
</style>
<script>
(function () {
  var body = document.body;
  if (!body) return;
  body.classList.add("reado-shell-pending");
  var mask = body.querySelector(".reado-shell-boot-mask");
  if (!mask) {
    mask = document.createElement("div");
    mask.className = "reado-shell-boot-mask";
    mask.setAttribute("aria-hidden", "true");
    body.appendChild(mask);
  }
  window.setTimeout(function () {
    if (!body.classList.contains("reado-shell-applied")) {
      body.classList.remove("reado-shell-pending");
    }
  }, 4000);
})();
</script>
<script src="/shared/book-catalog.js?v=1771779610833"></script>
<script type="module" src="/shared/shell.js?v=1771779610833"></script>
<reado-app-shell data-page="market"></reado-app-shell>
<header class="h-16 flex-none z-50 px-6 flex items-center justify-between glass-panel sticky top-0 border-b border-primary/10">
<div class="flex items-center gap-8">
<div class="flex items-center gap-2">
<div class="w-8 h-8 rounded bg-neon-cyan flex items-center justify-center text-background-dark shadow-[0_0_10px_rgba(0,243,255,0.5)]">
<span class="material-icons text-xl">auto_stories</span>
</div>
<h1 class="text-xl font-bold tracking-tight logo-font text-white">reado</h1>
</div>
<div class="hidden md:flex items-center gap-1 text-sm font-medium text-slate-400">
<span>首页</span>
<span class="material-icons text-xs">chevron_right</span>
<span class="text-neon-cyan neon-text">交易中心</span>
</div>
</div>
<div class="flex items-center gap-6">
<div class="flex items-center gap-2 bg-primary/10 px-4 py-1.5 rounded-full border border-neon-cyan/30">
<span class="material-icons text-neon-cyan text-sm">diamond</span>
<span class="text-sm font-bold text-white tracking-wide">12,850</span>
<div class="w-4 h-4 rounded-full bg-neon-cyan/20 flex items-center justify-center cursor-pointer hover:bg-neon-cyan/40 transition-colors ml-1">
<span class="material-icons text-[10px] text-neon-cyan">add</span>
</div>
</div>
<div class="flex items-center gap-3 pl-6 border-l border-white/10">
<div class="text-right hidden sm:block">
<div class="text-sm font-bold text-white leading-none mb-1">亚历克斯·陈</div>
<div class="text-[10px] text-neon-cyan uppercase tracking-widest font-bold">LV.42 顶级探索者</div>
</div>
<div class="relative">
<div class="w-10 h-10 rounded-lg p-[2px] bg-gradient-to-tr from-neon-cyan to-primary shadow-neon">
<img alt="User" class="w-full h-full rounded-[0.35rem] object-cover bg-background-dark" src="/assets/remote-images/3ec2fbb52c0ab37789b9f619.png"/>
</div>
<div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-background-dark rounded-full"></div>
</div>
</div>
</div>
</header>
<div class="flex-1 flex overflow-hidden">
<nav class="w-60 flex-none flex flex-col py-6 glass-panel border-r border-white/5">
<div class="px-6 mb-8">
<p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em]">主菜单</p>
</div>
<div class="flex flex-col gap-1">
<a class="flex items-center gap-4 px-6 py-3 text-slate-400 hover:text-white hover:bg-white/5 transition-all font-medium" href="/pages/gamified-learning-hub-dashboard-1">
<span class="material-symbols-outlined">map</span>
<span>知识版图</span>
</a>
<a class="flex items-center gap-4 px-6 py-3 text-slate-400 hover:text-white hover:bg-white/5 transition-all font-medium" href="/pages/simulator-library-level-selection-2">
<span class="material-symbols-outlined">assignment</span>
<span>任务中心</span>
</a>
<a class="flex items-center gap-4 px-6 py-3 text-slate-400 hover:text-white hover:bg-white/5 transition-all font-medium" href="/pages/global-scholar-leaderboard">
<span class="material-symbols-outlined">leaderboard</span>
<span>排行榜</span>
</a>
<a class="flex items-center gap-4 px-6 py-3 nav-active font-bold" href="/pages/gamified-learning-hub-dashboard-3">
<span class="material-symbols-outlined">shopping_cart</span>
<span>交易中心</span>
</a>
<a class="flex items-center gap-4 px-6 py-3 text-slate-400 hover:text-white hover:bg-white/5 transition-all font-medium" href="/pages/gamified-learning-hub-dashboard-2">
<span class="material-symbols-outlined">person</span>
<span>个人资料</span>
</a>
</div>
<div class="mt-auto px-4">
<div class="bg-neon-cyan/5 rounded-xl border border-neon-cyan/20 p-4 relative overflow-hidden">
<div class="absolute -right-4 -top-4 w-16 h-16 bg-neon-cyan/10 rounded-full blur-xl"></div>
<h3 class="text-[10px] font-bold text-neon-cyan uppercase tracking-wider mb-1">PRO 会员</h3>
<p class="text-xs text-white/80 leading-relaxed mb-3">解锁全库 500+ 本书籍深度模拟</p>
<button class="w-full py-2 bg-neon-cyan text-background-dark text-xs font-bold rounded hover:bg-white transition-colors">
                    立即升级
                </button>
</div>
</div>
</nav>
<main class="flex-1 overflow-y-auto p-8 scrollbar-hide dark:bg-[#0d131b]">
<div class="max-w-6xl mx-auto">
<div class="flex items-end justify-between mb-10">
<div>
<h2 class="text-3xl font-bold text-white mb-2 tracking-tight">知识模拟器 <span class="text-neon-cyan ml-2 neon-text">MARKET</span></h2>
<p class="text-slate-400 text-sm">消耗宝石解锁神经重构模块，永久提升认知属性。</p>
</div>
<div class="flex gap-3">
<div class="flex bg-card-dark rounded p-1 border border-white/5">
<button class="px-4 py-1.5 bg-neon-cyan/20 text-neon-cyan text-xs font-bold rounded shadow-sm">全部</button>
<button class="px-4 py-1.5 text-slate-500 text-xs font-bold rounded hover:text-slate-300">已解锁</button>
</div>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
<div class="bg-card-dark rounded-xl border border-white/5 hover:border-neon-cyan/50 transition-all group overflow-hidden flex flex-col shadow-lg">
<div class="relative h-44 overflow-hidden">
<img alt="思考，快与慢" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-80" src="/assets/remote-images/a3e69cb31a0c82a56dbf1f57.png"/>
<div class="absolute inset-0 bg-gradient-to-t from-card-dark via-card-dark/20 to-transparent"></div>
<div class="absolute top-3 left-3 px-2 py-0.5 bg-neon-cyan/20 backdrop-blur-md border border-neon-cyan/30 rounded text-[10px] font-bold text-neon-cyan">
                            心理学模拟器
                        </div>
</div>
<div class="p-5 flex-1 flex flex-col">
<h3 class="text-lg font-bold text-white mb-1">思考，快与慢</h3>
<p class="text-xs text-slate-500 mb-4 font-medium">丹尼尔·卡尼曼</p>
<p class="text-xs text-slate-400 leading-relaxed line-clamp-2 mb-5">
                            系统1与系统2的博弈，揭示人类决策背后的认知偏差与直觉陷阱。
                        </p>
<div class="space-y-2 mb-6">
<div class="flex justify-between items-center text-[10px] font-bold">
<span class="text-slate-500">属性加成预期</span>
<span class="text-neon-cyan">LEVEL 1</span>
</div>
<div class="flex flex-wrap gap-2">
<span class="px-2 py-1 bg-neon-cyan/5 border border-neon-cyan/20 rounded text-[10px] text-neon-cyan">批判思维 +15</span>
<span class="px-2 py-1 bg-white/5 border border-white/10 rounded text-[10px] text-slate-300">决策效率 +10</span>
</div>
</div>
<div class="mt-auto pt-4 border-t border-white/5 flex items-center justify-between">
<div class="flex items-center gap-1.5">
<span class="material-icons text-neon-cyan text-sm">diamond</span>
<span class="text-lg font-bold text-white">2,400</span>
</div>
<button class="px-5 py-2 bg-neon-cyan text-background-dark text-xs font-extrabold rounded-lg hover:brightness-110 shadow-neon-shadow transition-all">
                                解锁模块
                            </button>
</div>
</div>
</div>
<div class="bg-card-dark rounded-xl border border-white/5 hover:border-neon-cyan/50 transition-all group overflow-hidden flex flex-col shadow-lg">
<div class="relative h-44 overflow-hidden">
<img alt="微观动机" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-80" src="/assets/remote-images/f2fe9878f5629aa72156981c.png"/>
<div class="absolute inset-0 bg-gradient-to-t from-card-dark via-card-dark/20 to-transparent"></div>
<div class="absolute top-3 left-3 px-2 py-0.5 bg-neon-cyan/20 backdrop-blur-md border border-neon-cyan/30 rounded text-[10px] font-bold text-neon-cyan">
                            社会学模拟器
                        </div>
</div>
<div class="p-5 flex-1 flex flex-col">
<h3 class="text-lg font-bold text-white mb-1">微观动机</h3>
<p class="text-xs text-slate-500 mb-4 font-medium">托马斯·谢林</p>
<p class="text-xs text-slate-400 leading-relaxed line-clamp-2 mb-5">
                            探究微观动机如何通过群体互动转化为宏观现象，理解社会秩序。
                        </p>
<div class="space-y-2 mb-6">
<div class="flex justify-between items-center text-[10px] font-bold">
<span class="text-slate-500">属性加成预期</span>
<span class="text-neon-cyan">LEVEL 1</span>
</div>
<div class="flex flex-wrap gap-2">
<span class="px-2 py-1 bg-neon-cyan/5 border border-neon-cyan/20 rounded text-[10px] text-neon-cyan">博弈感知 +12</span>
<span class="px-2 py-1 bg-white/5 border border-white/10 rounded text-[10px] text-slate-300">群体解码 +20</span>
</div>
</div>
<div class="mt-auto pt-4 border-t border-white/5 flex items-center justify-between">
<div class="flex items-center gap-1.5">
<span class="material-icons text-neon-cyan text-sm">diamond</span>
<span class="text-lg font-bold text-white">1,850</span>
</div>
<button class="px-5 py-2 bg-neon-cyan text-background-dark text-xs font-extrabold rounded-lg hover:brightness-110 shadow-neon-shadow transition-all">
                                解锁模块
                            </button>
</div>
</div>
</div>
<div class="bg-card-dark rounded-xl border border-white/5 hover:border-neon-cyan/50 transition-all group overflow-hidden flex flex-col shadow-lg">
<div class="relative h-44 overflow-hidden">
<img alt="人类简史" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-80" src="/assets/remote-images/4232b6af196168e861963bb9.png"/>
<div class="absolute inset-0 bg-gradient-to-t from-card-dark via-card-dark/20 to-transparent"></div>
<div class="absolute top-3 left-3 px-2 py-0.5 bg-neon-cyan/20 backdrop-blur-md border border-neon-cyan/30 rounded text-[10px] font-bold text-neon-cyan">
                            历史学模拟器
                        </div>
</div>
<div class="p-5 flex-1 flex flex-col">
<h3 class="text-lg font-bold text-white mb-1">人类简史</h3>
<p class="text-xs text-slate-500 mb-4 font-medium">尤瓦尔·赫拉利</p>
<p class="text-xs text-slate-400 leading-relaxed line-clamp-2 mb-5">
                            跨越数万年的宏大叙事，审视智人如何统治地球并构建虚拟秩序。
                        </p>
<div class="space-y-2 mb-6">
<div class="flex justify-between items-center text-[10px] font-bold">
<span class="text-slate-500">属性加成预期</span>
<span class="text-neon-cyan">LEVEL 1</span>
</div>
<div class="flex flex-wrap gap-2">
<span class="px-2 py-1 bg-neon-cyan/5 border border-neon-cyan/20 rounded text-[10px] text-neon-cyan">宏观格局 +25</span>
<span class="px-2 py-1 bg-white/5 border border-white/10 rounded text-[10px] text-slate-300">叙事解构 +18</span>
</div>
</div>
<div class="mt-auto pt-4 border-t border-white/5 flex items-center justify-between">
<div class="flex items-center gap-1.5">
<span class="material-icons text-neon-cyan text-sm">diamond</span>
<span class="text-lg font-bold text-white">3,200</span>
</div>
<button class="px-5 py-2 bg-neon-cyan text-background-dark text-xs font-extrabold rounded-lg hover:brightness-110 shadow-neon-shadow transition-all">
                                解锁模块
                            </button>
</div>
</div>
</div>
</div>
</div>
</main>
<aside class="w-72 flex-none bg-background-dark border-l border-white/5 flex flex-col h-full z-40 hidden xl:flex">
<div class="p-6 border-b border-white/5">
<h2 class="font-bold text-sm text-white mb-4 uppercase tracking-wider">活跃加成模块</h2>
<div class="space-y-3">
<div class="flex items-center gap-3 bg-white/5 p-3 rounded border border-white/10">
<div class="w-8 h-8 rounded bg-neon-cyan/20 flex items-center justify-center">
<span class="material-symbols-outlined text-neon-cyan text-sm">speed</span>
</div>
<div class="flex-1">
<div class="text-[11px] font-bold text-white">速读协议 v4.0</div>
<div class="text-[9px] text-slate-400">处理效率 +30%</div>
</div>
<div class="w-1.5 h-1.5 rounded-full bg-neon-cyan shadow-[0_0_5px_#00f3ff]"></div>
</div>
<div class="flex items-center gap-3 bg-white/5 p-3 rounded border border-white/10">
<div class="w-8 h-8 rounded bg-primary/20 flex items-center justify-center">
<span class="material-symbols-outlined text-primary text-sm">memory</span>
</div>
<div class="flex-1">
<div class="text-[11px] font-bold text-white">知识锚点扩展</div>
<div class="text-[9px] text-slate-400">保留深度 +15%</div>
</div>
<div class="w-1.5 h-1.5 rounded-full bg-primary shadow-[0_0_5px_#1978e5]"></div>
</div>
</div>
</div>
<div class="p-6">
<h2 class="font-bold text-sm text-white mb-4 uppercase tracking-wider">今日特价道具</h2>
<div class="bg-gradient-to-br from-card-dark to-background-dark p-4 rounded-xl border border-neon-cyan/20 group cursor-pointer hover:border-neon-cyan/40 transition-all">
<div class="flex gap-3 mb-3">
<div class="w-10 h-10 bg-neon-cyan/10 rounded flex items-center justify-center flex-none">
<span class="material-icons text-neon-cyan text-xl">bolt</span>
</div>
<div>
<h3 class="font-bold text-white text-xs">专注增强剂</h3>
<p class="text-[10px] text-slate-500">2小时专注力峰值加成</p>
</div>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center gap-1">
<span class="material-icons text-neon-cyan text-xs">diamond</span>
<span class="text-sm font-bold text-white">450</span>
</div>
<button class="px-3 py-1 bg-white/5 hover:bg-neon-cyan hover:text-background-dark text-white text-[10px] font-bold rounded border border-white/10 transition-all">
                        购买
                    </button>
</div>
</div>
<div class="mt-6 p-4 rounded bg-black/30 border border-dashed border-white/10 text-center">
<span class="material-icons text-slate-600 text-2xl mb-2">lock</span>
<p class="text-[10px] text-slate-500">更多插槽将在<br/><span class="text-neon-cyan">LV.45</span> 等级解锁</p>
</div>
</div>
<div class="mt-auto p-6 border-t border-white/5">
<div class="flex items-center justify-between text-[10px] font-bold text-slate-500 mb-2">
<span>每日精神值</span>
<span class="text-neon-cyan">85/100</span>
</div>
<div class="w-full bg-white/5 h-1 rounded-full overflow-hidden">
<div class="bg-neon-cyan h-full w-[85%] shadow-[0_0_10px_#00f3ff]"></div>
</div>
</div>
</aside>
</div>


<style id="reado-market-book-style">
.reado-market-book-card {
  background: rgba(23, 33, 46, 0.95);
}
.reado-market-book-tag {
  position: absolute;
  top: 12px;
  left: 12px;
  padding: 2px 8px;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 700;
  border: 1px solid rgba(0, 243, 255, 0.4);
  background: rgba(0, 243, 255, 0.14);
  color: #9cf6ff;
}
.reado-market-filter-btn {
  color: #64748b !important;
  background: transparent !important;
  transition: all 150ms ease;
}
.reado-market-filter-btn.active {
  background: rgba(0, 243, 255, 0.2) !important;
  color: #9cf6ff !important;
  box-shadow: 0 2px 10px rgba(0, 243, 255, 0.12);
}
</style>
<script id="reado-market-book-script">
(() => {
  const catalog = window.__READO_BOOK_CATALOG__;
  const books = Array.isArray(catalog?.books) ? catalog.books : [];
  const storageKey = catalog?.storage?.unlockKey || "reado_unlocked_books_v1";
  const grid = document.querySelector("main .grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.gap-6");
  const allButton = Array.from(document.querySelectorAll("main button")).find((btn) => (btn.textContent || "").trim() === "全部");
  const unlockedButton = Array.from(document.querySelectorAll("main button")).find((btn) => (btn.textContent || "").trim() === "已解锁");
  if (!grid) return;
  let currentFilter = "all";

  const getUnlocked = () => {
    try {
      const parsed = JSON.parse(localStorage.getItem(storageKey) || "[]");
      return new Set(Array.isArray(parsed) ? parsed : []);
    } catch {
      return new Set();
    }
  };

  const saveUnlocked = (set) => {
    localStorage.setItem(storageKey, JSON.stringify([...set]));
  };

  const updateFilterUi = () => {
    if (!allButton || !unlockedButton) return;
    allButton.classList.add("reado-market-filter-btn");
    unlockedButton.classList.add("reado-market-filter-btn");
    allButton.classList.toggle("active", currentFilter === "all");
    unlockedButton.classList.toggle("active", currentFilter === "unlocked");
  };

  const getVisibleBooks = (unlocked) => {
    if (currentFilter === "unlocked") {
      return books.filter((book) => unlocked.has(book.id));
    }
    return books;
  };

  const createCard = (book, isUnlocked) => {
    const tagsHtml = (book.tags || [])
      .map((tag) => `<span class="px-2 py-1 bg-neon-cyan/5 border border-neon-cyan/20 rounded text-[10px] text-neon-cyan">${tag}</span>`)
      .join("");
    return `
      <div class="bg-card-dark reado-market-book-card rounded-xl border border-white/5 hover:border-neon-cyan/50 transition-all group overflow-hidden flex flex-col shadow-lg">
        <div class="relative h-52 overflow-hidden flex items-center justify-center bg-slate-950/70 border-b border-white/5">
          <img src="${book.cover}" alt="${book.title}" class="h-full w-auto object-contain group-hover:scale-105 transition-transform duration-500 opacity-90" loading="lazy" />
          <div class="absolute inset-0 bg-gradient-to-t from-card-dark/80 via-transparent to-transparent pointer-events-none"></div>
          <div class="reado-market-book-tag">${book.categoryLabel}</div>
        </div>
        <div class="p-5 flex-1 flex flex-col">
          <h3 class="text-lg font-bold text-white mb-1">${book.title}</h3>
          <p class="text-xs text-slate-400 mb-2">${book.moduleCount} 个体验模块</p>
          <p class="text-[11px] text-slate-400 mb-2 leading-relaxed">覆盖领域：${book.categoryIncludes}</p>
          <p class="text-[11px] text-slate-300 mb-4">通关收益：${book.categoryHint}</p>
          <div class="flex flex-wrap gap-2 mb-5">${tagsHtml || '<span class="px-2 py-1 bg-neon-cyan/5 border border-neon-cyan/20 rounded text-[10px] text-neon-cyan">谈资盲盒</span>'}</div>
          <div class="mt-auto pt-4 border-t border-white/5 flex items-center justify-between">
            <div class="flex items-center gap-1.5">
              <span class="material-icons text-neon-cyan text-sm">diamond</span>
              <span class="text-lg font-bold text-white">${book.price}</span>
            </div>
            <button data-id="${book.id}" data-href="${book.hubHref}" data-first="${book.firstModuleHref}" class="px-4 py-2 text-xs font-extrabold rounded-lg transition-all ${isUnlocked ? "bg-emerald-400/20 text-emerald-200 border border-emerald-300/30" : "bg-neon-cyan text-background-dark hover:brightness-110"}">
              ${isUnlocked ? "开始体验" : "购买书籍"}
            </button>
          </div>
        </div>
      </div>`;
  };

  const render = () => {
    const unlocked = getUnlocked();
    const visibleBooks = getVisibleBooks(unlocked);
    if (visibleBooks.length === 0) {
      grid.innerHTML = `
      <div class="md:col-span-2 lg:col-span-3 rounded-xl border border-white/10 bg-card-dark p-8 text-center">
        <h3 class="text-lg font-bold text-white">${books.length === 0 ? "书库为空" : "你还没有解锁任何书籍"}</h3>
        <p class="text-slate-400 text-sm mt-2">${books.length === 0 ? "请先在统一书籍数据中配置模块。" : "切换到“全部”后，选择想购买的模块开始体验。"}</p>
      </div>`;
      return;
    }
    grid.innerHTML = visibleBooks.map((book) => createCard(book, unlocked.has(book.id))).join("");
  };

  if (allButton && unlockedButton) {
    allButton.addEventListener("click", () => {
      currentFilter = "all";
      updateFilterUi();
      render();
    });
    unlockedButton.addEventListener("click", () => {
      currentFilter = "unlocked";
      updateFilterUi();
      render();
    });
  }

  grid.addEventListener("click", (event) => {
    const target = event.target;
    if (!(target instanceof HTMLElement)) return;
    const button = target.closest("button[data-id]");
    if (!button) return;
    const id = button.getAttribute("data-id");
    const href = button.getAttribute("data-href");
    const first = button.getAttribute("data-first");
    if (!id || !href || !first) return;
    const unlocked = getUnlocked();
    if (unlocked.has(id)) {
      const book = books.find((item) => item.id === id);
      const forceFirst = book?.id === "wanli-fifteen";
      if (forceFirst) {
        localStorage.removeItem("reado_book_last_" + id);
        window.location.href = first;
        return;
      }
      const last = localStorage.getItem("reado_book_last_" + id);
      const canResume = Boolean(last && Array.isArray(book?.moduleSlugs) && book.moduleSlugs.includes(last));
      window.location.href = canResume ? "/experiences/" + last : first;
      return;
    }
    unlocked.add(id);
    saveUnlocked(unlocked);
    window.location.href = href;
  });

  updateFilterUi();
  render();
})();
</script>
</body></html>